---
title: Logistic Regression Practice 1
date: 2021-04-18 14:00:00
categories:
  - Machine Learning
tags:
  - machine-learning
  - ml
  - knn
  - regression
  - kaggle
  - competition
typora-root-url: ../
---



## [ML] LRì„ í™œìš©í•œ ë¶„ë¥˜ ë¬¸ì œ (1)

> Week#6 / Reference: Prof.Choi / based on Colab, Kaggle



### Overview

#### ì€í•˜ê³„ ë¶„ë¥˜

> ë³¸ ë°ì´í„° ì…‹ì€ ê´€ì¸¡ í›„ í˜•íƒœì— ë”°ë¼ ë¶„ë¥˜ëœ ì€í•˜ê³„ë¡œ êµ¬ì„±ë˜ì–´ ìˆìœ¼ë©°, ì„¸ì¢…ëŒ€í•™êµ ìµœìœ ê²½ êµìˆ˜ë‹˜ì˜ [ì€í•˜ê³„ ë¶„ë¥˜](https://www.kaggle.com/c/2021-ml-p4) kaggle competitionë¥¼ ì¶œì²˜ë¡œ ë‘”ë‹¤.

#### Description

ë‹¤ìŒê³¼ ê°™ì´ 3ê°€ì§€ ì¢…ë¥˜ì˜ ì€í•˜ ë°ì´í„° ì…‹ì´ ì œê³µëœë‹¤.

- **Spiral** - ì¼ë°˜ì ìœ¼ë¡œ ì•Œë ¤ì§„ ë‚˜ì„  í˜•íƒœì˜ ì€í•˜
- **Edge** - ì€í•˜ëŠ” ë‚˜ì„  ì€í•˜ì§€ë§Œ ê´€ì¸¡ ë°©í–¥ì— ì˜í•´ ë¾°ì¡±í•œ í˜•íƒœë¥¼ ë„ëŠ” ì€í•˜
- **Smooth** - ì€í•˜ëŠ” ì€í•˜ ë””ìŠ¤í¬ì˜ ë‘ê»˜ê°€ ì–‡ì§€ ì•Šê³  ë‘ê»ê²Œ ë³´ì´ëŠ” ì€í•˜

í¸ì˜ë¥¼ ìœ„í•´ ê° ì€í•˜ê³„ ì‚¬ì§„ì€ 1D Feature ë¡œ ê°€ê³µë˜ì–´ ì œê³µëœë‹¤. 2D ì˜ìƒì„ 1Dë¡œ í‘œí˜„í•˜ê¸° ìœ„í•œ ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

> ê° ì‚¬ì§„ì€ ImageNetìœ¼ë¡œ pretrainëœ VGG16ì„ í™œìš©í•˜ì—¬ 1-Dim ì˜ ë²¡í„°ë¡œ ì œê³µëœë‹¤. ì´ ë²¡í„°ëŠ” ì¢…ë‹¨ ë‘ ê°œì˜ FC Layerë¥¼ í†µí•´ ë‚˜ì˜¨ 4,096 ì°¨ì›ì˜ ë²¡í„°ì— PCAë¥¼ ì‚¬ìš©í•´ 64ì°¨ì›ìœ¼ë¡œ ê°€ê³µë˜ì–´ ì œê³µëœë‹¤.

í•™ìŠµ ë°ì´í„°ëŠ” ì´ 6,000ê°œ, í‰ê°€ ë°ì´í„°ëŠ” ì´ 1,500ê°œì´ë©° í•™ìŠµë°ì´í„°ì— í•´ë‹¹ë˜ëŠ” ë¶„ë¥˜ ì •ë³´ë„ í¬í•¨í•œë‹¤.



### Preparation

- kaggle install

  ~~~python
  !pip uninstall -y kaggle
  !pip install --upgrade pip
  !pip install kaggle==1.5.6
  ~~~

- API token upload

  ~~~python
  !mkdir -p ~/.kaggle
  !cp kaggle.json ~/.kaggle/
  !chmod 600 ~/.kaggle/kaggle.json
  ~~~

- Import libraries

  ~~~python
  import numpy as np
  import pandas as pd
  ~~~


### Data Loading

Competitionì˜ Data íƒ­ì—ì„œ í•„ìš”í•œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¨ë‹¤.

- Import dataset from Kaggle

  ~~~python
  !kaggle competitions download -c 2021-ml-p4
  !unzip 2021-ml-p4.zip
  ~~~

- Input data

  ~~~python
  tdp = pd.read_csv('train_desc_pca.csv')
  tl = pd.read_csv('train_label.csv')
  test = pd.read_csv('test_desc_pca.csv')
  
  X = tdp # labelì„ ì œì™¸í•œ features ì •ë³´ Xì— ì €ì¥
  y = tl.drop('Id', axis=1) # 'Id' column drop í›„ labelê°’ë§Œ ì €ì¥
  ~~~
  


### Data Preprocessing

- Normalization

  ~~~python
  from sklearn.preprocessing import MinMaxScaler # ì •ê·œí™” method import
  msc = MinMaxScaler()
  
  X_sc = msc.fit_transform(X,y) # Xë¥¼ fití•  ë•Œ yë„ í•¨ê»˜ ë„£ì–´ì¤Œìœ¼ë¡œì¨ ê²½í–¥ì„± ì¡°ì ˆ
  test_sc = msc.transform(test) # testëŠ” (X,y)ì˜ ê²½í–¥ì— ë§ì¶˜ë‹¤
  ~~~
  
- Data framing

  ~~~python
X_sc = pd.DataFrame(X_sc,columns=X.columns)
  test_sc = pd.DataFrame(test_sc,columns=test.columns)
  ~~~
  
- Fitting / Scoring

  > Logistic regressionì˜ í•¨ìˆ˜ parameter ì¡°ì ˆì„ í†µí•´ ë‹¤ì–‘í•œ ê·œì œê°•ë„ì— ë”°ë¥¸ ì‹¤í—˜ì„ í•  ìˆ˜ ìˆë‹¤.

  - Lâ‚, Lâ‚‚ ê·œì œí™”
  - C = 1/ğœ† ë¥¼ í†µí•œ ê·œì œí™”
  - Test dataì˜ labelì„ ì•Œ ìˆ˜ ì—†ì„ ê²½ìš°, train data ì¼ë¶€ë¥¼ validation dataë¡œ êµ¬ì„±í•˜ì—¬ test

  ê·œì œê°•ë„ê°€ í´ìˆ˜ë¡ ì¶”ì •ëœ ê³„ìˆ˜ë“¤ì˜ ì ˆëŒ€ê°’ì´ ì‘ì•„ì§„ë‹¤. Lâ‚ ê·œì œí™”ì˜ ê²½ìš° ê·œì œ ê°•ë„ê°€ í´ìˆ˜ë¡ "Sparce", ê³„ìˆ˜ì— 0ì´ ë§ì•„ì§„ë‹¤.  ì¦‰, ê³„ìˆ˜ì— ëŒ€ì‘í•˜ëŠ” íŠ¹ì„±ë³€ìˆ˜ë¥¼ ì œê±°í•˜ëŠ” ì—­í• ì„ ë‹´ë‹¹í•œë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤. ë³¸ ì½”ë“œì—ì„œëŠ” C ê°’ì„ ì¡°ì ˆí•˜ë©° ì •í™•ë„ë¥¼ í–¥ìƒì‹œì¼œ ë³´ì•˜ë‹¤.

  ~~~python
  from sklearn.linear_model import LogisticRegression
  clf = LogisticRegression(random_state=1, C=1.6, max_iter=300)
  clf.fit(X_sc, y) # í•™ìŠµ ì ìš©
  
  result = clf.predict(test_sc) # ì˜ˆì¸¡ ì ìš©
  ~~~

- Submission

  ~~~python
submit = pd.read_csv('sample_submit.csv')
  submit['Category'] = result
  ~~~
  
~~~python
  submit.to_csv('submit.csv',index=False)
  ~~~
  
~~~python
  !kaggle competitions submit -c 2021-ml-p4 -f submit.csv -m "minmax, fit X, C=1.6, maxiter=300, solver=saga"
  ~~~
  
  




### Result

<img src="/images/post15-ml-w5-3/3.png" alt="score" style="zoom:40%;border:none" /> 

MAEì— ë”°ë¼ 1283.53995 ì •ë„ë¡œ í‰ê°€ë˜ì—ˆë‹¤. Leaderboard ìƒì—ì„œëŠ” 86ëª… ì¤‘ 13th positionì •ë„ì´ë‹¤. ì•„ì‰½ê²Œ deadline ì´í›„ì— ë” ì¢‹ì€ ì ìˆ˜ê°€ ë‚˜ì™€ì„œ public scoreì—ëŠ” ë°˜ì˜ë˜ì§€ ì•Šì•˜ë‹¤. :sob: