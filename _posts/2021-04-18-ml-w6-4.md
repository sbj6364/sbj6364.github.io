---
title: Logistic Regression Practice 2
date: 2021-04-18 17:00:00
categories:
  - Machine Learning
tags:
  - machine-learning
  - ml
  - logistic-regression
  - classification
  - practice
  - kaggle
  - competition
typora-root-url: ../
---



## [ML] LRì„ í™œìš©í•œ ë¶„ë¥˜ ë¬¸ì œ (2)

> Week#6 / Reference: Prof.Choi / based on Colab, Kaggle



### Overview

#### ìˆ˜ë©´ ì‹œê°„ì— ë”°ë¥¸ ìš°ìš¸ì¦ ì˜ˆì¸¡

> ë³¸ ë°ì´í„°ì…‹ì€ ë‹¤íŠ¸ë¨¸ìŠ¤ ëŒ€í•™êµ í•™ìƒë“¤ì—ê²Œ ìˆ˜ì§‘í•œ ì„¤ë¬¸ì¡°ì‚¬ë¥¼ í† ëŒ€ë¡œ ë§Œë“¤ì–´ì§„ ë°ì´í„°ì…‹ì´ë‹¤. ìì„¸í•œ ë‚´ìš©ì€ [ë§í¬](https://studentlife.cs.dartmouth.edu/)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©°, ì„¸ì¢…ëŒ€í•™êµ ìµœìœ ê²½ êµìˆ˜ë‹˜ì˜ [ìˆ˜ë©´ ì‹œê°„ì— ë”°ë¥¸ ìš°ìš¸ì¦ ì˜ˆì¸¡](https://www.kaggle.com/c/2021-ml-p8) kaggle competitionë¥¼ ì¶œì²˜ë¡œ ë‘”ë‹¤.

#### Description

<img src="/images/post16-ml-w6-4/1.png" alt="student-life" style="zoom:80%;border:none" />

ë³¸ ë°ì´í„°ì…‹ì€ ë‹¤íŠ¸ë¨¸ìŠ¤ëŒ€í•™êµ í•™ìƒë“¤ì„ ëŒ€ìƒìœ¼ë¡œ ì¼ì • ê¸°ê°„ë™ì•ˆ ìˆ˜ì§‘í•œ ìŠ¤ë§ˆíŠ¸í° ì„¼ì„œ ë°ì´í„°ì™€ ë‹¤ì–‘í•œ ì„¤ë¬¸ì¡°ì‚¬ ê²°ê³¼ë¥¼ í¬í•¨í•˜ê³  ìˆë‹¤. ê·¸ ì¤‘ ë³¸ ì‹¤ìŠµë¬¸ì œì—ì„œëŠ” í•™ìƒë“¤ì´ ì‘ë‹µí•œ 'ìˆ˜ë©´ì‹œê°„ ë° ìˆ˜ë©´ì˜ ì§ˆ' ê´€ë ¨ ì„¤ë¬¸ì¡°ì‚¬ì™€ 'PHQ-9' ì„¤ë¬¸ì¡°ì‚¬ë¥¼ ì‚¬ìš©í•  ì˜ˆì •ì´ë©°, ì´ë¥¼ í†µí•´ ìš°ìš¸ì¦ì˜ ìœ ë¬´ë¥¼ íŒë‹¨í•  ì˜ˆì •ì´ë‹¤. ë³¸ ë°ì´í„°ì…‹ì„ ì œê³µí•œ ì—°êµ¬íŒ€ì€ í•™ìƒë“¤ì—ê²Œ ìˆ˜ë©´ê³¼ ê´€ë ¨í•´ ë‹¤ìŒê³¼ ê°™ì€ ì§ˆë¬¸ì„ ì§„í–‰í•˜ì˜€ë‹¤.

> 1. "How many hours did you sleep last night?"
> 2. "How would rate your overall sleep last night?"

ìœ„ ì§ˆë¬¸ì— ëŒ€í•´ì„œ í•™ìƒë“¤ì€ ì„¤ì¹˜ëœ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ í†µí•´ì„œ ì„¤ë¬¸ì¡°ì‚¬ì— ì‘í•˜ì˜€ê³ , ì´ì™€ ê´€ë ¨ëœ ë°ì´í„°ì…‹ì˜ ìì„¸í•œ ë‚´ìš©ì€ [Student Life Dataset](https://studentlife.cs.dartmouth.edu/dataset.html) ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ë³¸ ë¬¸ì œì—ì„œëŠ” ì‚¬ì „ì— ì„¤ë¬¸ì¡°ì‚¬ ì‘ë‹µì— ëŒ€í•œ ì „ì²˜ë¦¬ë¥¼ ì§„í–‰í•˜ì˜€ê³ , í•™ìƒë“¤ì˜ ìˆ˜ë©´ì˜ ì‹œê°„, ìˆ˜ë©´ì˜ ì§ˆì— ëŒ€í•œ ì‘ë‹µì— ëŒ€í•´ì„œ [Pandas](https://pandas.pydata.org/)ì—ì„œ ì œê³µí•˜ëŠ” [describe](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.describe.html?highlight=describe#pandas.DataFrame.describe) í•¨ìˆ˜ë¥¼ ì´ìš©í•´ featureë¥¼ ì„¤ê³„í•˜ì˜€ë‹¤.

ë”°ë¼ì„œ ì¶”ê°€ì ì¸ ë°ì´í„° ì „ì²˜ë¦¬ ì—†ì´ ì œê³µë˜ëŠ” Featureë¥¼ ê¸°ì¡´ machine learning ë°©ë²•ì„ í†µí•´ì„œ í•™ìŠµí•˜ê³ , í‰ê°€ë¥¼ ìˆ˜í–‰í•˜ê³ ì í•œë‹¤. Featureì— ëŒ€í•œ ìì„¸í•œ ì„¤ëª…ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

- **train_X, test_X** : ìˆ˜ë©´ ê´€ë ¨(ìˆ˜ë©´ì˜ ì–‘/ìˆ˜ë©´ì˜ ì§ˆ) Feature(14ê°œ)
  - sleep_time_mean
  - sleep_time_std
  - sleep_time_min
  - sleep_time_25
  - sleep_time_50
  - sleep_time_75
  - sleep_time_max
  - sleep_quality_mean
  - sleep_quality_std
  - sleep_quality_min
  - sleep_quality_25
  - sleep_quality_50
  - sleep_quality_75
  - sleep_quality_max

- **train_Y** : ìš°ìš¸ì¦ ìœ /ë¬´ë¥¼ í‘œê¸°
  - 0 : PHQ 9 ì¢…í•© ì ìˆ˜ 5ì ì´í•˜
  - 1 : PHQ 9 ì¢…í•© ì ìˆ˜ 6ì ì´ìƒ

- **sample_submit** : ì œì¶œì„ ìœ„í•œ ì–‘ì‹



### Preparation

- kaggle install

  ~~~python
  !pip uninstall -y kaggle
  !pip install --upgrade pip
  !pip install kaggle==1.5.6
  ~~~

- API token upload

  ~~~python
  !mkdir -p ~/.kaggle
  !cp kaggle.json ~/.kaggle/
  !chmod 600 ~/.kaggle/kaggle.json
  ~~~

- Import libraries

  ~~~python
  import numpy as np
  import pandas as pd
  ~~~



### Data Loading

Competitionì˜ Data íƒ­ì—ì„œ í•„ìš”í•œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¨ë‹¤.

- Import dataset from Kaggle

  ~~~python
  !kaggle competitions download -c 2021-ml-p8
  !unzip 2021-ml-p8.zip
  ~~~

- Input data

  ~~~python
  X = pd.read_csv('train_X.csv')
  y = pd.read_csv('train_Y.csv')
  test = pd.read_csv('test_X.csv')
  ~~~
  
  ~~~python
  # pandas to numpy
  X = X.to_numpy()
y = y.to_numpy()
  test = test.to_numpy()
  ~~~
  
  

### Data Modeling

- Fitting

  > ì•ì„  í¬ìŠ¤íŒ…ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ Logistic regressionì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì—, í•¨ìˆ˜ parameter ì¡°ì ˆì„ í†µí•´ ë‹¤ì–‘í•œ ê·œì œê°•ë„ì— ë”°ë¥¸ ì‹¤í—˜ì„ í•´ ë³´ì•˜ë‹¤. ê´€ë ¨ ë‚´ìš©ì€ í•œë²ˆ ë” ë©”ëª¨í•œë‹¤.

  - Lâ‚, Lâ‚‚ ê·œì œí™”
  - C = 1/ğœ† ë¥¼ í†µí•œ ê·œì œí™”
  - Test dataì˜ labelì„ ì•Œ ìˆ˜ ì—†ì„ ê²½ìš°, train data ì¼ë¶€ë¥¼ validation dataë¡œ êµ¬ì„±í•˜ì—¬ test

  ê·œì œê°•ë„ê°€ í´ìˆ˜ë¡ ì¶”ì •ëœ ê³„ìˆ˜ë“¤ì˜ ì ˆëŒ€ê°’ì´ ì‘ì•„ì§„ë‹¤. Lâ‚ ê·œì œí™”ì˜ ê²½ìš° ê·œì œ ê°•ë„ê°€ í´ìˆ˜ë¡ "Sparce", ê³„ìˆ˜ì— 0ì´ ë§ì•„ì§„ë‹¤.  ì¦‰, ê³„ìˆ˜ì— ëŒ€ì‘í•˜ëŠ” íŠ¹ì„±ë³€ìˆ˜ë¥¼ ì œê±°í•˜ëŠ” ì—­í• ì„ ë‹´ë‹¹í•œë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤.

  í•˜ì§€ë§Œ ì´ë²ˆ ì½”ë“œì—ì„œëŠ” ì´ì „ì²˜ëŸ¼ C ê°’ì„ ì¡°ì ˆí•˜ë©° ì •í™•ë„ë¥¼ í–¥ìƒì‹œí‚¤ëŠ” ê²ƒì´ ì•„ë‹Œ, `class_weight` parameterë¥¼ ê±´ë“œë ¤ ë³´ì•˜ë‹¤. y label dataë¥¼ ë³´ë©´ 0ê°’ì´ 1ê°’ë³´ë‹¤ ëˆˆì— ë„ê²Œ ë§ì€ ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ì´ëŠ” ê²°êµ­ data imbalanceë¥¼ ì´ˆë˜í•˜ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì—, `class_weight` parameterì˜ valueë¥¼ `'balanced'`ë¡œ ì§€ì •í•´ ì£¼ì—ˆë‹¤.

  ~~~python
  from sklearn.linear_model import LogisticRegression
  lr = LogisticRegression(class_weight='balanced')
  lr.fit(X, y.reshape(-1)) # y vectorë¥¼ flatten ì‹œì¼œì£¼ëŠ” ê³¼ì •
  
  result = lr.predict(test)
  ~~~

- Submission

  ~~~python
submit = pd.read_csv('sample_submit.csv')
  submit['label'] = result
  ~~~
  
  ~~~python
  submit.to_csv('submit.csv',index=False)
  ~~~
  
  ~~~python
  !kaggle competitions submit -c 2021-ml-p8 -f submit.csv -m "Message"
  ~~~
  
  


### Result

<img src="/images/post16-ml-w6-4/2.png" alt="score" style="zoom:40%;border:none" /> 

ë¬¸ì œë¥¼ í’€ì–´ ë‚˜ê°€ê³  ëª¨ë¸ì„ í•™ìŠµ ì‹œí‚¤ë©° ì„±ëŠ¥ì„ ë†’ì´ëŠ” ê³¼ì •ì—ì„œ official manualì„ ì ì ˆíˆ ì°¸ê³ í•˜ëŠ” ê²ƒì´ ì–¼ë§ˆë‚˜ ì¤‘ìš”í•œ ê²ƒì¸ì§€ ë¼ˆì €ë¦¬ê²Œ ëŠë‚€ë‹¤. Scikit-learn ë¿ë§Œ ì•„ë‹ˆë¼ pandas, numpy, seaborn, matplotlib ë“± ìˆ˜ë§ì€ libraryë“¤ì˜ official documentsëŠ” ê·¸ëƒ¥ ë§Œë“¤ì–´ ë‘”ê²Œ ì•„ë‹ ê²ƒì´ë‹¤. ë³´ë¼ê³  ë§Œë“¤ì–´ ë‘” ê±°ë‹¤. ë³´ë¼ê³ ~!